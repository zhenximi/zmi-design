<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript" src="./js/Libraries/jquery.js"></script>
    <script src="./js/Libraries/jquery-migrate.js" charset="utf-8"></script>
    <link rel="stylesheet" type="text/css" href="./Assets/css/mettel-metone.css">
    <link rel="stylesheet" type="text/css" href="./Assets/css/mettel-metone-blessed1.css">
    <link rel="stylesheet" type="text/css" href="./Assets/css/mettel-metone-blessed2.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/Libraries/knockout.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/Libraries/knockout-postbox.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/Libraries/knockout.mapping-latest.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/mettel-metone.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/mettel-grid.js"></script>
  </head>
  <body>
    <div data-mettel-class="simple-grid" data-bind="
    grid: {
        gridName: 'Locations',
        columns: {
            explicit: ['Status', 'Age', 'Type', 'Ticket', 'Sched', 'Hierarchy', 'Address']
        },
        endPoints: {
            getGridData: '/data/help-desk-split-screen.json',
            saveGridSetting: '/Api/Grid/SaveGridSetting'
        },
        multiselect: false,
        frozenHeader: false,
        loadButtons: {
            loadAllLimit: 100
        },
        splitScreen: {
            hiddenFields: ['Hierarchy', 'Address']
        },
        queryParams: {
            clientId: '83784',
            status: 1
        },
        customColumnTemplates: {
            'TicketStat': 'custom-column-ticketStatus',
            'BillGrpID': 'custom-column-billGrpID'
        },
        customHeaderTemplates: {
            'TicketStat': 'custom-header-column-ticketStatus',
            'BillGrpID': 'custom-header-column-locationID'
        }
    }">
    </div>


    <script>
        $(document).ready(function() {
            // grid setup
            var $grid = $('[data-mettel-class="simple-grid"]')[0];
            var simpleGridModel = new GridModel();
            ko.applyBindings(simpleGridModel, $grid);

            // Purely here to get access to the model for debugging.
            window.foo = simpleGridModel;

            // // snapshot setup
            // // var $snapshotColumn = $('.mettel-column-two');
            // // $snapshotColumn.addClass('mettel-ticket-snapshot-container');
            //
            // // map setup
            // // var $mapColumn = $('.mettel-help-desk-map-container'),
            // //     vmHelpDeskMap = new HelpDeskMapModel();
            // // $mapColumn.addClass('mettel-column-two');
            // // $snapshotColumn.after($mapColumn);
            //
            // // ko.applyBindings(vmHelpDeskMap, $mapColumn[0]);
            //
            // // setup of events when selecting a grid row
            // ko.postbox.subscribe("selectedRowKey", function(newValue) {
            //     if (newValue !== undefined) {
            //
            //         var ticketModel = new TicketModel();
            //         ticketModel.endPoints = {};
            //         ticketModel.actionCallback = function(lineId, actionId) {
            //             console.log('The line Id is ' + lineId);
            //             console.log('The action Id is ' + actionId);
            //         };
            //         ticketModel.workTicketCallback = function(ticketId) {
            //             console.log('The ticket data is ' + ticketId);
            //         };
            //         ticketModel.closeTicketCallback = function(ticketId) {
            //             console.log('Close ticket ', ticketId);
            //         };
            //
            //         ticketModel.endPoints.getTicketData = '/api/ticket?ticketId=' + newValue;
            //         ticketModel.init();
            //
            //         ko.applyBindingsToNode($snapshotColumn[0], {
            //             template: {
            //                 name: 'ticket-snapshot',
            //                 data: ticketModel
            //             }
            //         });
            //
            //         $mapColumn.hide();
            //         $snapshotColumn.show();
            //
            //         // handling 'close' of a ticket snapshot
            //         $('.mettel-ticket-snapshot-close').on('click', function() {
            //             simpleGridModel.clearSelectedRows();
            //             $mapColumn.show();
            //             $snapshotColumn.hide();
            //         });
            //     }
            // });
            //
            // simpleGridModel.selectedPrimaryKey.publishOn("selectedRowKey");
            //
            // //vmHelpDeskMap.selectedLocationId.publishOn("helpDeskMap.selectedLocationId");
            //
            // // update the grid when a map location is clicked
            // // ko.postbox.subscribe("helpDeskMap.selectedLocationId", function(newValue) {
            // //     this.gridParametersModel.addQueryParams({
            // //         locationId: newValue
            // //     });
            // // }, simpleGridModel);
        });
    </script>
  </body>
</html>
